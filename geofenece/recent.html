<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>recent</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <link rel="stylesheet" href="/account-settings/css/header.css" />
    <link rel="stylesheet" href="recent.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
    />
  </head>

  <body style="margin: 0">
    <div class="device-container">
      <div class="device-topbar">
        <a href="/Home/Home.html" id="closeSidebar" class="icon-button-2">
          <!-- Back Arrow -->
          <svg
            width="14"
            height="12"
            viewBox="0 0 14 12"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M0.293945 5.29414C-0.0966797 5.68477 -0.0966797 6.31914 0.293945 6.70977L5.29395 11.7098C5.68457 12.1004 6.31895 12.1004 6.70957 11.7098C7.1002 11.3191 7.1002 10.6848 6.70957 10.2941L3.4127 7.00039H13.0002C13.5533 7.00039 14.0002 6.55352 14.0002 6.00039C14.0002 5.44727 13.5533 5.00039 13.0002 5.00039H3.41582L6.70645 1.70664C7.09707 1.31602 7.09707 0.681641 6.70645 0.291016C6.31582 -0.0996094 5.68145 -0.0996094 5.29082 0.291016L0.29082 5.29102L0.293945 5.29414Z"
              fill="#5D5D5D"
            />
          </svg>
        </a>
        <div class="device-title">Recent Geofence Report</div>
        <div class="device-user">
          <svg
            width="16"
            height="16"
            viewBox="0 0 14 16"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M7 8C8.06087 8 9.07828 7.57857 9.82843 6.82843C10.5786 6.07828 11 5.06087 11 4C11 2.93913 10.5786 1.92172 9.82843 1.17157C9.07828 0.421427 8.06087 0 7 0C5.93913 0 4.92172 0.421427 4.17157 1.17157C3.42143 1.92172 3 2.93913 3 4C3 5.06087 3.42143 6.07828 4.17157 6.82843C4.92172 7.57857 5.93913 8 7 8ZM5.57188 9.5C2.49375 9.5 0 11.9937 0 15.0719C0 15.5844 0.415625 16 0.928125 16H13.0719C13.5844 16 14 15.5844 14 15.0719C14 11.9937 11.5063 9.5 8.42813 9.5H5.57188Z"
              fill="#27B9CD"
            />
          </svg>

          <span class="device-badge">3</span>
        </div>
      </div>
      <div class="geo-report-card">
        <div class="geo-form-row">
          <label class="geoform-label">Status:</label>
          <div class="geoform-select-wrap">
            <select class="geoform-select">
              <option>Select Device</option>
            </select>
            <span class="geoform-dropdown-arrow">
              <svg width="20" height="20" fill="none">
                <path
                  d="M7 10L12 15L17 10"
                  stroke="#b9bec7"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </span>
          </div>
        </div>

        <div class="geo-form-row">
          <label class="geoform-label">Geofence:</label>
          <div class="geoform-select-wrap">
            <select class="geoform-select">
              <option>Select Device</option>
            </select>
            <span class="geoform-dropdown-arrow">
              <svg width="20" height="20" fill="none">
                <path
                  d="M7 10L12 15L17 10"
                  stroke="#b9bec7"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </span>
          </div>
        </div>

        <div class="geo-form-row">
          <label class="geoform-label">Date Range:</label>
          <div class="geoform-select-wrap">
            <input
              type="text"
              class="geo-date-input"
              value="08/04/2025 to 08/10/2025"
              readonly
            />
            <input class="geoform-select" />
            <span class="geoform-dropdown-arrow">
              <!-- Calendar icon positioned right -->
              <svg
                width="15"
                height="16"
                viewBox="0 0 15 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M12.8846 2.07617L2.11538 2.07617C1.22323 2.07617 0.5 2.7994 0.5 3.69156L0.5 13.3839C0.499999 14.276 1.22323 14.9992 2.11538 14.9992L12.8846 14.9992C13.7768 14.9992 14.5 14.276 14.5 13.3839L14.5 3.69156C14.5 2.7994 13.7768 2.07617 12.8846 2.07617Z"
                  stroke="#BBBBBB"
                  stroke-linejoin="round"
                />
                <path
                  d="M8.84614 8.00015C9.29222 8.00015 9.65384 7.63853 9.65384 7.19246C9.65384 6.74638 9.29222 6.38477 8.84614 6.38477C8.40007 6.38477 8.03845 6.74638 8.03845 7.19246C8.03845 7.63853 8.40007 8.00015 8.84614 8.00015Z"
                  fill="#BBBBBB"
                />
                <path
                  d="M11.5384 8.00015C11.9845 8.00015 12.3461 7.63853 12.3461 7.19246C12.3461 6.74638 11.9845 6.38477 11.5384 6.38477C11.0923 6.38477 10.7307 6.74638 10.7307 7.19246C10.7307 7.63853 11.0923 8.00015 11.5384 8.00015Z"
                  fill="#BBBBBB"
                />
                <path
                  d="M8.84614 10.6916C9.29222 10.6916 9.65384 10.3299 9.65384 9.88386C9.65384 9.43779 9.29222 9.07617 8.84614 9.07617C8.40007 9.07617 8.03845 9.43779 8.03845 9.88386C8.03845 10.3299 8.40007 10.6916 8.84614 10.6916Z"
                  fill="#BBBBBB"
                />
                <path
                  d="M11.5384 10.6916C11.9845 10.6916 12.3461 10.3299 12.3461 9.88386C12.3461 9.43779 11.9845 9.07617 11.5384 9.07617C11.0923 9.07617 10.7307 9.43779 10.7307 9.88386C10.7307 10.3299 11.0923 10.6916 11.5384 10.6916Z"
                  fill="#BBBBBB"
                />
                <path
                  d="M3.4615 10.6916C3.90758 10.6916 4.26919 10.3299 4.26919 9.88386C4.26919 9.43779 3.90758 9.07617 3.4615 9.07617C3.01542 9.07617 2.65381 9.43779 2.65381 9.88386C2.65381 10.3299 3.01542 10.6916 3.4615 10.6916Z"
                  fill="#BBBBBB"
                />
                <path
                  d="M6.15388 10.6916C6.59996 10.6916 6.96158 10.3299 6.96158 9.88386C6.96158 9.43779 6.59996 9.07617 6.15388 9.07617C5.70781 9.07617 5.34619 9.43779 5.34619 9.88386C5.34619 10.3299 5.70781 10.6916 6.15388 10.6916Z"
                  fill="#BBBBBB"
                />
                <path
                  d="M3.4615 13.3849C3.90758 13.3849 4.26919 13.0233 4.26919 12.5772C4.26919 12.1311 3.90758 11.7695 3.4615 11.7695C3.01542 11.7695 2.65381 12.1311 2.65381 12.5772C2.65381 13.0233 3.01542 13.3849 3.4615 13.3849Z"
                  fill="#BBBBBB"
                />
                <path
                  d="M6.15388 13.3849C6.59996 13.3849 6.96158 13.0233 6.96158 12.5772C6.96158 12.1311 6.59996 11.7695 6.15388 11.7695C5.70781 11.7695 5.34619 12.1311 5.34619 12.5772C5.34619 13.0233 5.70781 13.3849 6.15388 13.3849Z"
                  fill="#BBBBBB"
                />
                <path
                  d="M8.84614 13.3849C9.29222 13.3849 9.65384 13.0233 9.65384 12.5772C9.65384 12.1311 9.29222 11.7695 8.84614 11.7695C8.40007 11.7695 8.03845 12.1311 8.03845 12.5772C8.03845 13.0233 8.40007 13.3849 8.84614 13.3849Z"
                  fill="#BBBBBB"
                />
                <path
                  d="M3.19226 1L3.19226 2.07692M11.8076 1L11.8076 2.07692"
                  stroke="#BBBBBB"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M14.5 4.76953L0.5 4.76953"
                  stroke="#BBBBBB"
                  stroke-linejoin="round"
                />
              </svg>
            </span>
          </div>
        </div>

        <button class="geoform-submit">Submit</button>

        <!-- Sales Car 1 expanded -->
        <div id="geoCarContainer"></div>
      </div>
    </div>
    <script>
      const geoCars = [
        {
          name: "Sales Car 1",
          device: "Device A",
          geofence: "Geofence 1",
          imei: "220902734",
          status: "Outside Geofence",
          date: "2025-08-04",
          time: "13:20:15",
          daysOutside: "10 days",
          location: "7014 E Camelback Rd, Scottsdale, AZ 85251",
        },
        {
          name: "Sales Car 2",
          device: "Device B",
          geofence: "Geofence 2",
          imei: "220902735",
          status: "Inside Geofence",
          date: "2025-08-04",
          time: "13:45:10",
          daysOutside: "15 days",
          location: "123 Main St, Phoenix, AZ 85001",
        },
        {
          name: "Sales Car 3",
          device: "Device C",
          geofence: "Geofence 1",
          imei: "220902736",
          status: "Inside Geofence",
          date: "2025-08-04",
          time: "14:10:55",
          daysOutside: "20 days",
          location: "456 Elm St, Scottsdale, AZ 85251",
        },
        {
          name: "Sales Car 4",
          device: "Device D",
          geofence: "Geofence 3",
          imei: "220902737",
          status: "Outside Geofence",
          date: "2025-08-05",
          time: "09:25:30",
          daysOutside: "50 days",
          location: "789 Oak St, Tempe, AZ 85281",
        },
        {
          name: "Sales Car 5",
          device: "Device E",
          geofence: "Geofence 2",
          imei: "220902738",
          status: "Inside Geofence",
          date: "2025-08-05",
          time: "10:15:20",
          daysOutside: "30 days",
          location: "321 Pine St, Mesa, AZ 85201",
        },
        {
          name: "Sales Car 6",
          device: "Device F",
          geofence: "Geofence 3",
          imei: "220902739",
          status: "Outside Geofence",
          date: "2025-08-05",
          time: "11:05:45",
          daysOutside: "40 days",
          location: "654 Maple St, Chandler, AZ 85224",
        },
      ];

      const container = document.getElementById("geoCarContainer");
      const deviceSelect = document.querySelectorAll(".geoform-select")[0];
      const geofenceSelect = document.querySelectorAll(".geoform-select")[1];
      const dateSelect = document.querySelectorAll(".geoform-select")[2];

      function populateFilters() {
        const devices = [...new Set(geoCars.map((c) => c.device))];
        const geofences = [...new Set(geoCars.map((c) => c.geofence))];
        const dates = [...new Set(geoCars.map((c) => c.date))];

        devices.forEach((d) => {
          const opt = document.createElement("option");
          opt.value = d;
          opt.textContent = d;
          deviceSelect.appendChild(opt);
        });

        geofences.forEach((g) => {
          const opt = document.createElement("option");
          opt.value = g;
          opt.textContent = g;
          geofenceSelect.appendChild(opt);
        });

        // dates.forEach((dt) => {
        //   const opt = document.createElement("option");
        //   opt.value = dt;
        //   opt.textContent = dt;
        //   dateSelect.appendChild(opt);
        // });
      }

      // ✅ Render Cards
      function renderCards(filteredCars = geoCars) {
        container.innerHTML = "";
        filteredCars.forEach((car, index) => {
          const card = document.createElement("div");
          card.className = "geo-car-card" + (index === 0 ? " open" : "");

          card.innerHTML = `
        <div class="geo-car-head">
          <span>${car.name}</span>
          <span class="geo-collapse-arrow">
            <svg width="20" height="19" viewBox="0 0 20 19" fill="none"
              xmlns="http://www.w3.org/2000/svg">
              <rect x="-0.5" y="0.5" width="19" height="17" rx="4.5"
                transform="matrix(-1 0 0 1 19 0.5)" fill="white"/>
              <rect x="-0.5" y="0.5" width="19" height="17" rx="4.5"
                transform="matrix(-1 0 0 1 19 0.5)" stroke="#D7DBE2"/>
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M9.5678 7.37249C9.68048 7.25984 9.83329 7.19656 
                9.99262 7.19656C10.1519 7.19656 10.3048 7.25984 
                10.4174 7.37249L13.8166 10.7716C13.874 10.827 
                13.9197 10.8933 13.9512 10.9667C13.9827 11.04 
                13.9993 11.1188 14 11.1986C14.0007 11.2784 
                13.9855 11.3575 13.9553 11.4313C13.925 11.5052 
                13.8804 11.5723 13.824 11.6287C13.7676 11.6851 
                13.7005 11.7297 13.6267 11.7599C13.5528 11.7902 
                13.4737 11.8054 13.3939 11.8047C13.3141 11.804 
                13.2353 11.7874 13.162 11.7559C13.0887 11.7244 
                13.0224 11.6786 12.9669 11.6212L9.99262 8.64694 
                L7.0183 11.6212C6.90498 11.7307 6.7532 11.7913 
                6.59565 11.7899C6.4381 11.7885 6.2874 11.7253 
                6.17599 11.6139C6.06458 11.5025 6.00139 11.3518 
                6.00002 11.1943C5.99865 11.0367 6.05922 10.8849 
                6.16867 10.7716L9.5678 7.37249Z"
                fill="#27B9CD"/>
            </svg>
          </span>
        </div>
        <div class="geo-car-details">
          <div class="geo-car-detail-row"><span>IMEI</span><span>${
            car.imei
          }</span></div>
          <div class="geo-car-detail-row"><span>Geofence Name</span><span>${
            car.geofence
          }</span></div>
          <div class="geo-car-detail-row"><span>Status</span>
            <span class="${
              car.status.includes("Outside") ? "status-red" : "status-green"
            }">${car.status}</span>
          </div>
          <div class="geo-car-detail-row"><span>Days Outside Geofence</span><span>${
            car.daysOutside
          }</span></div>
          <div class="geo-touchpoint-row">
            <div class="geoform-label touchpoint-label">Geofence Touchpoint</div>
            <div class="geo-car-detail-row"><span>Date</span><span>${
              car.date
            }</span></div>
            <div class="geo-car-detail-row"><span>Time</span><span>${
              car.time
            }</span></div>
            <div class="geo-car-detail-row"><span>Location</span>
              <span><a href="#" class="geoform-link">${car.location}</a></span>
            </div>
          </div>
        </div>
      `;

          container.appendChild(card);

          card
            .querySelector(".geo-collapse-arrow")
            .addEventListener("click", () => {
              card.classList.toggle("open");
            });
        });
      }

      document
        .querySelector(".geoform-submit")
        .addEventListener("click", () => {
          const selectedDevice = deviceSelect.value;
          const selectedGeofence = geofenceSelect.value;
          const selectedDate = dateSelect.value;

          let filtered = geoCars;

          if (selectedDevice !== "Select Device") {
            filtered = filtered.filter((c) => c.device === selectedDevice);
          }

          if (selectedGeofence !== "Select Device") {
            filtered = filtered.filter((c) => c.geofence === selectedGeofence);
          }

          if (selectedDate !== "Select Date Period") {
            filtered = filtered.filter((c) => c.date === selectedDate);
          }

          renderCards(filtered);
        });

      populateFilters();
      renderCards();

      document.addEventListener("DOMContentLoaded", function () {
        const dateRange = document.querySelector(".geo-date-input");

        flatpickr(dateRange, {
          mode: "range",
          dateFormat: "Y-m-d",
          onOpen: function () {
            console.log("Date range clicked");
          },
          onClose: function (selectedDates) {
            if (selectedDates.length === 2) {
              // Format dates to "Month DD, YYYY"
              const options = {
                year: "numeric",
                month: "long",
                day: "2-digit",
              };
              const start = selectedDates[0].toLocaleDateString(
                "en-US",
                options
              );
              const end = selectedDates[1].toLocaleDateString("en-US", options);

              // Update the <div class="geo-date-range">
              if (dateRangeDisplay) {
                dateRangeDisplay.textContent = `${start} - ${end}`;
              }

              console.log("Range selected:", start, "-", end);
            }
          },
        });
      });
    </script>
  </body>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
</html>
